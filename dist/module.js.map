{"mappings":"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","sources":["src/index.js"],"sourcesContent":["class Event {\n    #events = new Map();\n\n    on(event_name, callback) {\n        this.#events.set(event_name, callback);\n    }\n\n    fire(event_name, args = []) {\n        if (this.#events.has(event_name)) {\n            this.#events.get(event_name)(...args);\n        }\n    }\n}\n\nclass Route extends Event {\n    constructor(title, frames, scripts, links) {\n        super();\n\n        this.title = title;\n        this.last_loaded_time = new Date();\n        this.frames = frames;\n        this.scripts = scripts;\n        this.links = links;\n    }\n\n    render(router) {\n        this.last_loaded_time = new Date();\n\n        document.title = this.title;\n        window.scrollTo(0, 0);\n\n        // Load all scripts and stylesheets\n        let loadings = [];\n\n        this.links.forEach(href => {\n            loadings.push(\n                new Promise((resolve, _) => {\n                    let link = document.createElement('link');\n                    link.setAttribute('rel', 'stylesheet');\n                    link.setAttribute('href', href);\n                    link.onload = resolve;\n                    document.head.appendChild(link);\n                })\n            );\n        });\n\n        this.scripts.forEach(src => {\n            loadings.push(\n                new Promise((resolve, _) => {\n                    let script = document.createElement('script');\n                    script.setAttribute('type', 'text/javascript');\n                    script.setAttribute('src', src);\n                    script.onload = resolve;\n                    document.head.appendChild(script);\n                })\n            );\n        });\n\n        // When all scrips and stylesheets are loaded then render frames\n        Promise.all(loadings)\n            .then(() => {\n                for (const frame of document.querySelectorAll('ga-frame')) {\n                    const frame_name = frame.getAttribute('name');\n\n                    if (this.frames.has(frame_name)) {\n                        const page_frame = this.frames.get(frame_name);\n\n                        frame.innerHTML = page_frame;\n                        // TODO : bind follow behavior to frame links\n                        Route.init_links(frame, router);\n                    }\n                }\n\n                this.fire('mount');\n                // TODO : router.fire('change');\n                router.fire('change');\n            });\n    }\n\n    clean() {\n        this.links.forEach(href => document.head.querySelector(`link[href=\"${href}\"]`).remove());\n        this.scripts.forEach(src => {\n            document.head.querySelector(`script[src=\"${src}\"]`).remove()\n        });\n    }\n\n    static init_links(frame, router) {\n        frame\n            .querySelectorAll('[o-follow]')\n            .forEach(link => {\n                const o_follow = link.getAttribute('o-follow');\n                const href = link.getAttribute('href').substr(1);\n        \n                link.addEventListener('click', e => {\n                    e.preventDefault();\n        \n                    // Cannot click on link which target the same location as the current\n                    if (href === router.current_path) {\n                        return;\n                    }\n        \n                    router.fire('loading');\n                    const prev_url = router.current_path;\n        \n                    history.pushState({}, null, href);\n        \n                    router.pages.get(prev_url).clean();\n                    router.push(href);\n                });\n        \n                // Only bind event on follow link which have preload-once or preload value\n                if (['preload-once', 'preload'].includes(o_follow)) {\n                    link.addEventListener('mouseover', () => {\n                        if (o_follow === 'preload-once') {\n                            if (!router.pages.has(href)) {\n                                router.handle_url(href, true, false);\n                            }\n                        } else if (o_follow === 'preload') {\n                            router.handle_url(href, false, false);\n                        }\n                    });\n                }\n            });\n    }\n}\n\nconst extract_scripts = doc => [...doc.querySelectorAll('script')]\n    .filter(script => script.getAttribute('o-no-load') === null && script.getAttribute('src') !== null)\n    .map(script => script.attributes.src.nodeValue);\n\nconst extract_stylesheets = doc => [...doc.querySelectorAll('head > link[rel=stylesheet]')]\n    .filter(link => link.getAttribute('o-no-load') === null)\n    .map(link => link.attributes.href.nodeValue);\n\nconst extract_frames = doc => new Map([...doc.querySelectorAll('ga-frame')].map(frame => {\n        return [frame.getAttribute('name'), frame.innerHTML]\n    }));\n\nexport default class Router extends Event {\n    #cache = new Map();\n    #parser = new DOMParser();\n    #init = false;\n\n    get pages() {\n        return new Proxy(this.#cache, {\n            get(target, name) {\n                let res = Reflect.get(target, name);\n\n                if (typeof res === 'function' && (name === 'get' || name === 'has')) {\n                    res = res.bind(target);\n                }\n\n                return res\n            }\n        });\n    }\n\n    constructor() {\n        super();\n        // Init current page now to allow to link some events\n        const current_page = new Route(null, null, null, null);\n        this.#cache.set(this.current_path, current_page);\n\n        // Init behavior when DOM is mounted\n        document.addEventListener('readystatechange', e => {\n            // e.target.readyState === 'interactive' || \n            if ((e.target.readyState === 'complete') && !this.#init) {\n                // Prevent to execute each time the readyState change\n                this.#init = true;\n\n                current_page.title = document.title;\n                current_page.frames = extract_frames(document);\n                current_page.scripts = extract_scripts(document);;\n                current_page.links = extract_stylesheets(document);\n\n                Route.init_links(document, this);\n                // this.#init_links(document);\n                current_page.fire('mount');\n        \n                window.addEventListener('popstate', () => {\n                    // Find previous page and clean it\n                    const last_page_visited = [...this.#cache.entries()].sort((a, b) => {\n                        if (a[1].last_loaded_time < b[1].last_loaded_time)\n                            return 1\n                        if (a[1].last_loaded_time > b[1].last_loaded_time)\n                            return -1;\n        \n                        return 0\n                    })[0][1];\n            \n                    last_page_visited.fire('destroy');\n                    last_page_visited.clean();\n        \n                    // Render new route\n                    if (this.#cache.has(this.current_path)) {\n                        this.#cache.get(this.current_path).render(this);\n                    }\n                });\n            }\n        })\n    }\n\n    push(location, from_cache = true) {\n        if (from_cache && this.#cache.has(this.current_path)) {\n            this.#cache.get(this.current_path).render(this);\n        } else {\n            this.handle_url(location, true, true);\n        }\n    }\n\n    get current_path() {\n        return location.pathname.substr(1);\n    }\n\n    async handle_url(url, add_to_cache = true, do_rendering = true) {\n        let page = null;\n        let res = await fetch(url, {\n            headers: new Headers({\n                'GAR-LOG': null\n            })\n        });\n        const text = await res.text();\n\n        if (res.ok) {\n            const parsed_fragment = this.#parse(text);\n\n            if (add_to_cache) {\n                this.#cache.set(url, parsed_fragment);\n            }\n\n            if (!do_rendering) {\n                return;\n            }\n\n            page = parsed_fragment;\n        } else if (res.status === 404) {\n            if (!res) {\n                return;\n            }\n\n            page = this.#parse(text);\n        }\n\n        page.render(this);\n    }\n\n    #parse(content) {\n        const doc = this.#parser.parseFromString(content, 'text/html');\n\n        return new Route(\n            doc.title,\n            extract_frames(doc),\n            extract_scripts(doc),\n            extract_stylesheets(doc)\n        )\n    }\n\n    on(event_name, callback) {\n        switch (event_name) {\n            case 'mount':\n            case 'destroy':\n                this.#cache.get(this.current_path).on(event_name, callback);\n            break;\n\n            case 'loading':\n            case 'change':\n                super.on('change', callback);\n            break;\n            default:\n                throw new TypeError('Unrecognized event')\n        }\n    }\n}\n\nif (window.router === undefined) {\n    window.router = new Router();\n}"],"names":[],"version":3,"file":"module.js.map"}