{"mappings":"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","sources":["src/index.js"],"sourcesContent":["export default class Router {\n    constructor() {\n        this.cache = new Map();\n        this.parser = new DOMParser();\n\n        const frames = new Map();\n        for (const frame of document.querySelectorAll('ga-frame')) {\n            frames.set(frame.getAttribute('name'), frame.innerHTML);\n        }\n\n        window.addEventListener('popstate', () => {\n            window.dispatchEvent(new Event('ga-router:loading', { bubbles: true, cancelable: false }));\n            window.dispatchEvent(new Event('onDestroy'));\n\n            const last_page_visited = [...this.cache.entries()].sort((a, b) => {\n                if (a[1].last_loaded_time < b[1].last_loaded_time)\n                    return 1\n                if (a[1].last_loaded_time > b[1].last_loaded_time)\n                    return -1;\n\n                return 0\n            });\n\n            this.clean(last_page_visited);\n            this.handle_url(location.href);\n        });\n    }\n\n    caching(url, title, frames, scripts, links) {\n        this.cache.set(url, {\n            frames,\n            title,\n            last_loaded_time: Date.now(),\n            scripts,\n            links\n        });\n    }\n\n    async handle_url(url, add_to_cache = true, do_rendering = true) {\n        let page = this.cache.get(url);\n\n        if (page) {\n            page.last_loaded_time = Date.now();\n\n            if (do_rendering) {\n                this.render(page);\n            }\n\n            return;\n        }\n\n        let headers = new Headers();\n        headers.append('GAR-LOG', null);\n\n        let res = await fetch(url, { headers });\n\n        if (res.ok) {\n            res = await res.text();\n            const parsed_fragment = this.parse(res);\n\n            if (add_to_cache) {\n                this.caching(\n                    url,\n                    parsed_fragment.title,\n                    parsed_fragment.frames,\n                    parsed_fragment.scripts,\n                    parsed_fragment.links\n                );\n            }\n\n            page = parsed_fragment;\n            page.last_loaded_time = Date.now();\n\n            if (do_rendering) {\n                this.render(page);\n            }\n        } else if (res.status === 404) {\n            let parsed_fragment = this.parse(await res.text());\n            this.render(parsed_fragment);\n        }\n    }\n\n    parse(content) {\n        const doc = this.parser.parseFromString(content, 'text/html');\n        const frames = new Map();\n\n        for (const frame of doc.querySelector('ga-frame')) {\n            frames.set(frame.getAttribute('name'), frame.innerHTML);\n        }\n\n        return {\n            title: doc.title,\n            frames,\n            scripts: [...doc.querySelectorAll('script')]\n                .filter(script => script.getAttribute('o-no-load') === null && script.getAttribute('src') !== null)\n                .map(script => script.attributes.src.nodeValue),\n            links: [...doc.querySelectorAll('head > link[rel=stylesheet')]\n                .filter(link => link.getAttribute('o-no-load') === null)\n                .map(link => link.attributes.href.nodeValue)\n        }\n    }\n}\n\n// export default class Router {\n//     constructor() {\n//         this.cache = {};\n//         this.onMountEvent = new Event('onMount');\n//         this.onDestroyEvent = new Event('onDestroy');\n//         this.parser = new DOMParser();\n\n//         const frames = {};\n//         for (const frame of document.querySelectorAll('ga-frame')) {\n//             frames[frame.getAttribute('name')] = frame.innerHTML;\n//         }\n\n//         // Cache page on which the router has been initialized\n//         // TODO : handle case when script has no src attribute\n//         this.caching(\n//             location.href,\n//             document.title,\n//             frames,\n//             [...document.querySelectorAll('script')]\n//                 .filter(script => script.getAttribute('o-no-load') === null && script.getAttribute('src') !== null)\n//                 .map(script => script.attributes.src.nodeValue),\n//             [...document.querySelectorAll('head > link[rel=stylesheet]')]\n//                 .filter(link => link.getAttribute('o-no-load') === null)\n//                 .map(link => link.attributes.href.nodeValue)\n//         );\n\n//         window.dispatchEvent(this.onMountEvent);\n\n//         window.addEventListener('popstate', e => {\n//             window.dispatchEvent(new Event('router:loading', { bubbles: true, cancelable: false }))\n//             window.dispatchEvent(this.onDestroyEvent)\n\n//             const last_page_visited = Object.entries(this.cache).sort((a, b) => {\n//                 if (a[1].last_loaded_time < b[1].last_loaded_time)\n//                     return 1\n//                 if (a[1].last_loaded_time > b[1].last_loaded_time)\n//                     return -1;\n\n//                 return 0\n//             })[0][0];\n\n//             this.clean(last_page_visited)\n//             this.handle_url(location.href)\n//         })\n\n//         document.body.addEventListener('click', e => {\n//             const link = e.target instanceof HTMLAnchorElement\n//                 ? e.target\n//                 : e.target.parentElement instanceof HTMLAnchorElement\n//                     ? e.target.parentElement\n//                     : e.target.parentElement instanceof HTMLPictureElement\n//                         ? e.target.parentElement.parentElement\n//                         : null;\n\n//             if (link && link.href === window.location.href) {\n//                 e.preventDefault();\n//                 return;\n//             }\n\n//             if (link && link.matches('[o-follow]')) {\n//                 e.preventDefault();\n\n//                 window.dispatchEvent(new Event('router:loading', { bubbles: true, cancelable: false }))\n//                 window.dispatchEvent(this.onDestroyEvent)\n\n//                 // console.info('Remove old hooks', this.cache[location.href])\n//                 // window.removeEventListener('onMount', this.cache[location.href].onMount)\n//                 // window.removeEventListener('onDestroy', this.cache[location.href].onDestroy)\n\n//                 // const cached = this.cache[location.href]\n\n//                 // if (cached) {\n//                 //     // console.info('Remove old hooks', this.cache[location.href])\n//                 //     const onMount = this.cache[location.href].onMount;\n//                 //     if (onMount) window.removeEventListener('onMount', onMount);\n//                 //     const onDestroy = this.cache[location.href].onDestroy;\n//                 //     if (onDestroy) window.removeEventListener('onDestroy', onDestroy);\n\n//                 // }\n\n//                 history.pushState({ prevUrl: location.href }, null, link.href)\n                \n//                 this.clean(window.history.state.prevUrl)\n//                 this.handle_url(link.href, true, true)\n//             }\n//         })\n\n//         const links_preload = document.querySelectorAll('[o-preload]')\n//         const links_preload_once = document.querySelectorAll('[o-preload-once]')\n\n//         // Warn developer an unintended behavior may occur\n//         for (const link_preload_once of links_preload_once) {\n//             for (const link_preload of links_preload) {\n//                 if (link_preload_once == link_preload) {\n//                     console.warn('A link has [o-preload-once] and [o-preload] tags at the same time')\n//                 }\n//             }\n//         }\n        \n//         for (const link of links_preload) {\n//             link.addEventListener('mouseover', () => {\n//                 this.handle_url(link.href, true, false)\n//             })\n//             link.addEventListener('mouseleave', e => {\n//                 // delete pages[e.target.href]\n//             })\n//         }\n        \n//         for (const link of links_preload_once) {\n//             link.addEventListener('mouseover', () => {\n//                 if (!this.cache[link.href])\n//                     this.handle_url(link.href, true, false)\n//             })\n//         }\n//     }\n\n//     onMount(callback) {\n//         this.cache[location.href].onMount = callback\n//         // console.log('CREATE ONMOUNT', this.cache[location.href])\n//         window.addEventListener('onMount', this.cache[location.href].onMount)\n//     }\n\n//     onDestroy(callback) {\n//         this.cache[location.href].onDestroy = callback\n//         window.addEventListener('onDestroy', this.cache[location.href].onDestroy)\n//     }\n\n//     caching(url, title, frames, scripts, links) {\n//         this.cache[url] = {\n//             frames,\n//             title,\n//             last_loaded_time: Date.now(),\n//             scripts,\n//             links\n//         }\n//     }\n\n//     async handle_url(url, add_in_cache = true, do_rendering = true) {\n//         let page = this.cache[url];\n\n//         if (!page) {\n//             let headers = new Headers();\n//             headers.append('GAR-Log', false);\n\n//             let res = await fetch(url, {\n//                 headers\n//             });\n\n//             if (res.ok) {\n//                 res = await res.text()\n//                 let parsed_fragment = this.parse(res)\n        \n//                 if (add_in_cache) {\n//                     this.caching(\n//                         url,\n//                         parsed_fragment.title,\n//                         parsed_fragment.frames,\n//                         parsed_fragment.scripts,\n//                         parsed_fragment.links\n//                     )\n//                 }\n        \n//                 page = parsed_fragment;\n\n//                 page.last_loaded_time = Date.now();\n    \n//                 if (do_rendering === true)\n//                     this.render(page);\n//             } else if(res.status === 404) {\n//                 let parsed_fragment = this.parse(await res.text());\n//                 this.render(parsed_fragment);\n//             }\n//         } else {\n//             page.last_loaded_time = Date.now();\n    \n//             if (do_rendering === true)\n//                 this.render(page);\n//         }\n\n//     }\n\n//     parse(content) {\n//         const doc = this.parser.parseFromString(content, 'text/html');\n//         const frames = {};\n\n//         for (const frame of doc.querySelectorAll('ga-frame')) {\n//             frames[frame.getAttribute('name')] = frame.innerHTML;\n//         }\n\n//         return {\n//             title: doc.title,\n//             frames,\n//             scripts: [...doc.querySelectorAll('script')]\n//                 .filter(script => script.getAttribute('o-no-load') === null && script.getAttribute('src') !== null)\n//                 .map(script => script.attributes.src.nodeValue),\n//             links: [...doc.querySelectorAll('head > link[rel=stylesheet]')]\n//                 .filter(link => link.getAttribute('o-no-load') === null)\n//                 .map(link => link.attributes.href.nodeValue)\n//         }\n//     }\n\n//     render(page) {\n//         let loadings = []\n\n//         // window.dispatchEvent(new Event('router:loading'))\n\n//         page.scripts.forEach(newScript => {\n//             loadings.push(\n//                 new Promise((resolve, reject) => {\n//                     let script = document.createElement('script')\n//                     script.type = 'text/javascript'\n//                     script.src = newScript\n//                     script.onload = resolve\n//                     document.head.appendChild(script)\n//                 })\n//             )\n//         })\n\n//         document.title = page.title\n//         window.scrollTo(0, 0);\n\n//         page.links.forEach(link => {\n//             loadings.push(\n//                 new Promise((resolve, reject) => {\n//                     let link_el = document.createElement('link');\n//                     link_el.rel = 'stylesheet';\n//                     link_el.href = link;\n//                     link_el.onload = resolve;\n//                     document.head.appendChild(link_el);\n//                 })\n//             )\n//         })\n\n//         Promise.all(loadings)\n//             .then(() => {\n//                 for (let frame of document.querySelectorAll('ga-frame')) {\n//                     const page_frame = page.frames[frame.getAttribute('name')];\n        \n//                     if (page_frame !== undefined) {\n//                         frame.innerHTML = page_frame;\n//                     }\n//                 }\n\n//                 window.dispatchEvent(this.onMountEvent)\n\n//                 if (page.onMount) {\n//                     window.addEventListener('onMount', page.onMount)\n//                     // window.dispatchEvent(this.onMountEvent)\n//                 }\n//                 if (page.onDestroy) window.addEventListener('onDestroy', page.onDestroy)\n        \n//                 window.dispatchEvent(new Event('router:change'))\n//             })\n\n//     }\n\n//     clean(url) {\n//         const page_to_clear = this.cache[url]\n\n//         if (page_to_clear) {\n//             // Remove old CSS files\n//             page_to_clear.links.forEach(link => {\n//                 const link_el = document.head.querySelector(`link[href=\"${link}\"]`);\n//                 link_el.remove()\n//             })\n    \n//             // Remove old JS files\n//             page_to_clear.scripts.forEach(script => {\n//                 const script_el = document.head.querySelector(`script[src=\"${script}\"]`)\n//                 script_el.remove()\n//             })\n//         } else { // Page not in cache, maybe 404 page?\n//             // Remove old CSS files\n//             [...document.querySelectorAll('script')]\n//                 .filter(script => script.getAttribute('o-no-load') === null)\n//                 .forEach(script => script.remove());\n\n//             [...document.querySelectorAll('head > link[rel=stylesheet]')]\n//                 .filter(link => link.getAttribute('o-no-load') === null)\n//                 .forEach(link => link.remove());\n//         }\n\n//     }\n// }"],"names":[],"version":3,"file":"module.js.map"}